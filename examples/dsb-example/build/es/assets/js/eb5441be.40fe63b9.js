"use strict";(self.webpackChunkdevsecblueprint=self.webpackChunkdevsecblueprint||[]).push([[1235],{8193:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"projects/devsecops-pipeline-gcp/code-breakdown/devsecops-terraform-code","title":"DevSecOps Terraform Code - Explained","description":"---","source":"@site/docs/projects/devsecops-pipeline-gcp/code-breakdown/devsecops-infra.md","sourceDirName":"projects/devsecops-pipeline-gcp/code-breakdown","slug":"/projects/devsecops-pipeline-gcp/code-breakdown/devsecops-terraform-code","permalink":"/es/projects/devsecops-pipeline-gcp/code-breakdown/devsecops-terraform-code","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"devsecops-terraform-code","title":"DevSecOps Terraform Code - Explained","sidebar\\\\_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Application Code - Explained","permalink":"/es/projects/devsecops-pipeline-gcp/code-breakdown/application-code"},"next":{"title":"Deploying and Testing","permalink":"/es/category/deploying-and-testing-2"}}');var s=i(4848),o=i(8453);const t={id:"devsecops-terraform-code",title:"DevSecOps Terraform Code - Explained",sidebar_position:1},l=void 0,c={},d=[{value:"Overview",id:"overview",level:2},{value:"Code Overview",id:"code-overview",level:2},{value:"Core Infrastructure",id:"core-infrastructure",level:3},{value:"CI/CD Pipelines",id:"cicd-pipelines",level:3},{value:"Artifact Registry Configuration",id:"artifact-registry-configuration",level:4},{value:"Cloud Storage Bucket Configuration",id:"cloud-storage-bucket-configuration",level:4},{value:"Secret Management Configuration",id:"secret-management-configuration",level:4},{value:"FastAPI Pipeline Configuration",id:"fastapi-pipeline-configuration",level:4},{value:"Key Pipeline Parameters",id:"key-pipeline-parameters",level:4}];function a(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"With our environments configured and secrets created, it's time to dive into the Terraform code that defines the DevSecOps pipeline infrastructure. This guide provides a detailed explanation of the critical components so you can fully understand how the system works."}),"\n",(0,s.jsx)(n.h2,{id:"code-overview",children:"Code Overview"}),"\n",(0,s.jsxs)(n.p,{children:["All relevant code is located in the ",(0,s.jsx)(n.code,{children:"terraform"})," folder, which contains multiple Terraform modules:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"Core Infrastructure"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"CI/CD Pipelines"})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"core-infrastructure",children:"Core Infrastructure"}),"\n",(0,s.jsx)(n.p,{children:"This module provisions foundational infrastructure components such as storage, artifact registry, and secret management. It ensures that essential resources are available for secure DevSecOps operations."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Files"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"main.tf"}),": Defines storage buckets, artifact registries, and secret management resources."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"variables.tf"}),": Configures input variables, including project ID and region."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"provider.tf"}),": Configures the Google Cloud provider settings."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"cicd-pipelines",children:"CI/CD Pipelines"}),"\n",(0,s.jsx)(n.p,{children:"This module sets up Cloud Build pipelines, IAM roles, and GitHub integration for CI/CD automation. Below are the key elements explained in detail:"}),"\n",(0,s.jsx)(n.h4,{id:"artifact-registry-configuration",children:"Artifact Registry Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Resource"}),": ",(0,s.jsx)(n.code,{children:"google_artifact_registry_repository"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Provisions a ",(0,s.jsx)(n.strong,{children:"Docker artifact repository"})," for storing container images."]}),"\n",(0,s.jsx)(n.li,{children:"Ensures that all built images are stored securely and version-controlled."}),"\n",(0,s.jsx)(n.li,{children:"Enables seamless integration with Google Cloud Build for CI/CD pipelines."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"cloud-storage-bucket-configuration",children:"Cloud Storage Bucket Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Resource"}),": ",(0,s.jsx)(n.code,{children:"google_storage_bucket"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Provisions a Cloud Storage bucket for storing Cloud Build artifacts."}),"\n",(0,s.jsx)(n.li,{children:"Standardizes bucket naming conventions using variables."}),"\n",(0,s.jsx)(n.li,{children:"Ensures secure and centralized storage for build and deployment artifacts."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"secret-management-configuration",children:"Secret Management Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Resource"}),": ",(0,s.jsx)(n.code,{children:"google_secret_manager_secret"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stores sensitive information such as API tokens securely."}),"\n",(0,s.jsx)(n.li,{children:"Manages access control for secrets using IAM policies."}),"\n",(0,s.jsx)(n.li,{children:"Ensures integration with Cloud Build and other services."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"fastapi-pipeline-configuration",children:"FastAPI Pipeline Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Module"}),": ",(0,s.jsx)(n.code,{children:"gcp_python_fastapi_pipeline"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Purpose"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'Establishes a CI/CD pipeline for the "GCP FastAPI" project.'}),"\n",(0,s.jsx)(n.li,{children:"Leverages the GitHub connection to pull source code from the repository."}),"\n",(0,s.jsx)(n.li,{children:"Integrates the pipeline with the Cloud Storage bucket and Artifact Registry for seamless deployments."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"key-pipeline-parameters",children:"Key Pipeline Parameters"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"GitHub Integration"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Dynamically links the GitHub connection to Cloud Build triggers."}),"\n",(0,s.jsxs)(n.li,{children:["Configures repository details:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Repository: ",(0,s.jsx)(n.code,{children:"The-DevSec-Blueprint/gcp-python-fastapi"})]}),"\n",(0,s.jsxs)(n.li,{children:["Branch: ",(0,s.jsx)(n.code,{children:"main"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Build and Deployment"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Buildspec: Located at ",(0,s.jsx)(n.code,{children:"cloudbuild.yaml"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Build environment:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Machine type: ",(0,s.jsx)(n.code,{children:"E2_SMALL"})]}),"\n",(0,s.jsxs)(n.li,{children:["Image: ",(0,s.jsx)(n.code,{children:"gcr.io/cloud-builders/gcloud"})]}),"\n",(0,s.jsx)(n.li,{children:"Privileged mode enabled for containerized builds."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security Scanning"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Integrates ",(0,s.jsx)(n.strong,{children:"Snyk"})," for container security scanning."]}),"\n",(0,s.jsxs)(n.li,{children:["Uses ",(0,s.jsx)(n.code,{children:"SNYK_TOKEN"})," and ",(0,s.jsx)(n.code,{children:"project_id"})," variables for authentication."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"By understanding the purpose and structure of these Terraform configurations, you'll have a clearer picture of how the DevSecOps pipeline functions, from provisioning infrastructure to enabling secure and automated CI/CD workflows."})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var r=i(6540);const s={},o=r.createContext(s);function t(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);