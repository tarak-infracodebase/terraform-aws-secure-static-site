"use strict";(self.webpackChunkdevsecblueprint=self.webpackChunkdevsecblueprint||[]).push([[9705],{1067:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"projects/devsecops-home-lab/installation-and-configuration/install-config-gitea","title":"Gitea","description":"Overview","source":"@site/docs/projects/devsecops-home-lab/installation-and-configuration/gitea.md","sourceDirName":"projects/devsecops-home-lab/installation-and-configuration","slug":"/projects/devsecops-home-lab/installation-and-configuration/install-config-gitea","permalink":"/pt-PT/projects/devsecops-home-lab/installation-and-configuration/install-config-gitea","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"install-config-gitea","title":"Gitea","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Docker","permalink":"/pt-PT/projects/devsecops-home-lab/installation-and-configuration/install-config-docker"},"next":{"title":"Jenkins","permalink":"/pt-PT/projects/devsecops-home-lab/installation-and-configuration/install-config-jenkins"}}');var r=s(4848),t=s(8453);const l={id:"install-config-gitea",title:"Gitea",sidebar_position:2},a=void 0,o={},c=[{value:"Overview",id:"overview",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation Steps",id:"installation-steps",level:2},{value:"Configuration Steps",id:"configuration-steps",level:2},{value:"You&#39;re Done",id:"youre-done",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["This installation happens on the ",(0,r.jsx)(n.code,{children:"dsb-hub"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["According to ",(0,r.jsx)(n.a,{href:"https://about.gitea.com/products/gitea/",children:"Gitea"}),"'s documentation, Gitea is a painless self-hosted all-in-one software development service, including Git hosting, code review, team collaboration, package registry and CI/CD. It's open source under MIT license. It is designed to be lightweight, easy to use, and highly customizable, making it an ideal choice for both small teams and large organizations."]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Install PostgreSQL:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Run the following command to install PostgreSQL and its contrib package:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt install postgresql postgresql-contrib\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Switch to the PostgreSQL user:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo -i -u postgres\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Update the PostgreSQL configuration files:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/postgresql/16/main/postgresql.conf\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Scroll down and uncomment the ",(0,r.jsx)(n.code,{children:"listen_addresses"})," setting, then set it to ",(0,r.jsx)(n.code,{children:"localhost"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-conf",children:"listen_addresses = 'localhost'\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Scroll down and uncomment the ",(0,r.jsx)(n.code,{children:"password_encryption"})," setting, then set it to ",(0,r.jsx)(n.code,{children:"scram-sha-256"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-conf",children:"password_encryption = scram-sha-256\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Log into PostgreSQL:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Log into the PostgreSQL command line as the ",(0,r.jsx)(n.code,{children:"postgres"})," user:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"psql\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configure the Database:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a new role (user) for Gitea with a secure password and a new database owned by that role:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE ROLE gitea WITH LOGIN PASSWORD 'your_password';\r\nCREATE DATABASE giteadb WITH OWNER gitea TEMPLATE template0 ENCODING 'UTF8' LC_COLLATE 'en_US.UTF-8' LC_CTYPE 'en_US.UTF-8';\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Update the ",(0,r.jsx)(n.code,{children:"pg_hba.conf"})," file to allow the ",(0,r.jsx)(n.code,{children:"gitea"})," user to connect to the ",(0,r.jsx)(n.code,{children:"giteadb"})," database using ",(0,r.jsx)(n.code,{children:"scram-sha-256"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/postgresql/16/main/pg_hba.conf\n"})}),"\n",(0,r.jsx)(n.p,{children:"Add the following line:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-conf",children:"local    giteadb    gitea    scram-sha-256\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Test Database Connection:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Restart the PostgreSQL service and test the connection to the Gitea database:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo systemctl restart postgresql.service\r\npsql -U gitea -d giteadb\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Install Nginx:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Install Nginx using the following command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo apt install nginx\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configure Nginx:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Unlink the default configuration file:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo unlink /etc/nginx/sites-enabled/default\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a new configuration file for the reverse proxy:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-available/reverse-proxy\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Copy the following configuration into the file, then save and close it:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"server {\r\n    listen 80;\r\n    server_name localhost;\r\n\r\n    location / {\r\n        client_max_body_size 1000M; # This allows for large uploads up to one GB. Increase if you need more or have insanely large repositories.\r\n        proxy_pass http://127.0.0.1:3000;\r\n        proxy_set_header Host $host;\r\n        proxy_set_header X-Real-IP $remote_addr;\r\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n        proxy_set_header X-Forwarded-Proto $scheme;\r\n    }\r\n}\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Activate the new proxy configuration and restart Nginx:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo ln -s /etc/nginx/sites-available/reverse-proxy /etc/nginx/sites-enabled/\r\nsudo systemctl restart nginx\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"installation-steps",children:"Installation Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Install Gitea:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Install Gitea using Snap:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo snap install gitea\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Start the Gitea service:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo snap start gitea\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Configure web hooks:"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo nano /var/snap/gitea/common/conf/app.ini\r\n\r\n# Add this inside of the file\r\n[webhook]\r\nALLOWED_HOST_LIST = localhost, 127.0.0.1\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"configuration-steps",children:"Configuration Steps"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configure Gitea:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Open a web browser and navigate to your server's IP address or domain name."}),"\n",(0,r.jsxs)(n.li,{children:["Follow the on-screen instructions to configure Gitea, entering your previously created PostgreSQL database credentials when prompted.\r\n",(0,r.jsx)(n.img,{alt:"Gitea Setup Screenshot",src:s(6083).A+"",width:"2574",height:"1372"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Create an Account:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Create an admin account to manage your Gitea instance.\r\n",(0,r.jsx)(n.img,{alt:"Create Account Screenshot",src:s(2594).A+"",width:"2480",height:"1242"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"youre-done",children:"You're Done"}),"\n",(0,r.jsxs)(n.p,{children:["Gitea is now successfully installed and configured on your server. Feel free to log in and take a look around.\r\n",(0,r.jsx)(n.img,{alt:"Success Screenshot",src:s(9083).A+"",width:"1826",height:"690"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},2594:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/gitea-create-account-7276b6f4131ca268f5740961be7a4511.png"},6083:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/gitea-init-config-36cef2116c603d1284cce786fb1a9b8f.png"},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},9083:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/gitea-success-account-creation-62fc8471779a844faba2cc63313f62be.png"}}]);